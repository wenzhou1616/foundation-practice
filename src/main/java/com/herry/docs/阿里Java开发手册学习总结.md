# 编码规约

## 命名风格

Java本身的规则：

- 只能由字母、数字、下划线、美元符号组成
- 不能以数字开头
- 不能以关键字或保留字开头

以下规则都是在此基础之上的规则：

- 所有的命名不能以下划线或美元符号开头或结尾。

- 不能使用中文、拼音、拼音英文混合。

- 见名知意。

- 类名：
  - 大驼峰风格，每个单词的首次都大写，但DO / BO / DTO / VO / AO / PO / UID 等例外。
  - 抽象类：以 Abstract 或 Base 开头。
  - 异常类：以 Exception 结尾。
  - 测试类：以要测试的类开始，以Test结尾。
  - POJO 类：布尔类型的变量不能以 is 开头。
- 方法名、参数名、成员变量、局部变量：
  - 小驼峰风格，只有第一个单词小写，其他的都大写。
- 常量：
  - 所有字母大写，单词之间用下划线分隔。
- 数组：
  - 中括号要紧挨类型名，例如：int[] arr;
- 包名：全部小写，单数。但是工具类有复数的含义，类名可以复数。

- 使用尽量完整的单词 组合来表达其意。

正例：在 JDK 中，表达原子更新的类名为：`AtomicReferenceFieldUpdater`。

反例：变量 int a 的随意命名方式。

- 使用了设计模式，在命名时要体现。

正例：

```java
public class OrderFactory; 

public class LoginProxy; 

public class ResourceObserver;
```

- 接口：

  - 属性和方法不要加任何修饰符（public也不要加），保持代码简洁。

  - 配上有效的Javadoc注释。

  - 尽量不要定义变量，一定要定义也是和接口有关的常量。

  - 如果是形容能力的接口名称，取对应的形容词为接口名（通常是–able 的形式）。 

    正例：AbstractTranslator 实现 Translatable 接口。

- 实现类：

  - 实现类用 Impl 的后缀与接口区别。

  正例：CacheServiceImpl 实现 CacheService 接口。

- 枚举（参考）：

  - 枚举类名带上Enum后缀。
  - 成员全部大写，用下划线分隔单词。

- 各层命名规约（参考）： 

  - A) Service/DAO 层方法命名规约 
    - 1） 获取单个对象的方法用 get 做前缀。
    -  2） 获取多个对象的方法用 list 做前缀，复数形式结尾如：listObjects。 
    - 3） 获取统计值的方法用 count 做前缀。 
    - 4） 插入的方法用 save/insert 做前缀。 
    - 5） 删除的方法用 remove/delete 做前缀。 
    - 6） 修改的方法用 update 做前缀。 
  - B) 领域模型命名规约 
    - 1） 数据对象：xxxDO，xxx 即为数据表名。 
    - 2） 数据传输对象：xxxDTO，xxx 为业务领域相关的名称。 
    - 3） 展示对象：xxxVO，xxx 一般为网页名称。 
    - 4） POJO 是 DO/DTO/BO/VO 的统称，禁止命名成 xxxPOJO。

## 常量的定义

- 不允许任何魔法值（即未经预先定义的常量）直接出现在代码中。 

  反例：String key = "Id#taobao_" + tradeId; cache.put(key, value);

- 给long或Long赋值时，数值后面用L，不用小写，因为容易跟1混淆。、

- 根据常量的功能对常量进行分类，写在不同的类中。

- 常量复用的不同层次：

  1） 类内共享常量：直接在类内部 private static final 定义。

  2） 包内共享常量：即在当前包下单独的 constant 目录下。

  3） 子工程内部共享常量：即在当前子工程的 constant 目录下。

  4） 应用内共享常量：放置在一方库中，通常是子模块中的 constant 目录下。 

  反例：易懂变量也要统一定义成应用内共享常量，两位攻城师在两个类中分别定义了表示 “是”的变量：

   类 A 中：public static final String YES = "yes";

   类 B 中：public static final String YES = "y";

   A.YES.equals(B.YES)，预期是 true，但实际返回为 false，导致线上问题。

  5） 跨应用共享常量：放置在二方库中，通常是 client.jar 中的 constant 目录下。 

- 如果变量值仅在一个固定范围内变化用 enum 类型来定义。

  说明：如果存在名称之外的延伸属性应使用 enum 类型，下面正例中的数字就是延伸信息，表 示一年中的第几个季节。 

  正例： 

  ```java
  public enum SeasonEnum {
   SPRING(1), SUMMER(2), AUTUMN(3), WINTER(4);
   private int seq;
   SeasonEnum(int seq){
     this.seq = seq;
   }
  }
  ```

## 代码格式

- 大括号：次行风格。
- 小括号：括号内，左括号与字符不能有空格，右括号和字符也不能有空格。
- if/for/while/switch/do 等关键字与括号（大，小）之间都必须加空格。
- 任何二目、三目运算符的左右两边都需要加一个空格。 说明：运算符包括赋值运算符=、逻辑运算符&&、加减乘除符号等。
- 缩进：用4格空格。
- 注释：双斜线和注释内容之间要有一个空格。
- 换行：
  - 第二行缩进4个空格，从第三行开始不缩进。
  - 带上运算符一起缩进。
  - 在逗号后面换行。
  - 括号前不要换行。
- 方法参数：逗号后面必须加空格。

- 方法：不要操作80行（包括注释，空行等）
- 添加空行（推荐）：在不同的逻辑、语义、业务中添加一个空行可以提升可读性。

## OOP规约

- 不要用对象调用静态资源，会添加编译器解析成本。

- 所有的覆写的方法，都必须加上@Override注解。

- 可变参数：相同参数类型、业务含义才可以用可变参数，避免使用Object。但是尽量不要用可变参数。

- 正在调用的接口不允许修改方法名，避免对调用方产生影响。

- 过时接口必须要用@Deprecated注解，并清晰说明新接口是什么。

- 不能使用过时的方法或类。接口方既然明确是过时的接口，那就一定有新接口。

- 使用常量或确定有值的对象调用equals

  正例："test".equals(object); 

  反例：object.equals("test");

  说明：推荐使用 java.util.Objects#equals（JDK7 引入的工具类）

- 相同类型的包装类在比较时，要使用equals进行比较。因为在-128到127之间的对象会复用，但是之外的对象不会复用，因此在比较时统一使用equals。
- 基本数据类型和包装类的使用标准：
  - 所有POJO类的属性必须用包装类。
  - RPC方法的返回值和参数必须使用包装类。
  - 【推荐】所有的局部变量使用基本数据类型。



















